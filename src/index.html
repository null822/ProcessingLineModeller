<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Processing Line Modeller</title>

  <!--JetBrains Mono-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Doto:wght@100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  <meta name="theme-color" content="#fafafa">
</head>

<body>
  <div class="topbar-container">
    <div class="topbar">
      <input type="button" style="grid-area: recipe" class="topbar-button" value=">" onclick="Main.lookupRecipe()">
      <input type="button" style="grid-area: source"
             class="topbar-button topbar-button-half topbar-button-green" value="+"
             onclick="Main.addIO('source')">
      <input type="button" style="grid-area: drain"
             class="topbar-button topbar-button-half topbar-button-red" value="-"
             onclick="Main.addIO('drain')">
      <div style="grid-area: search" class="topbar-search">
        <input type="text" size="1" class="topbar-search-text" id="resource-search"
               onchange="Main.searchResourceCallback()"
               onkeydown="this.onchange()"
               onpaste="this.onchange()"
               oninput="this.onchange()"
               onfocusin="Main.onSearchResourceResultsFocusChance()"
               onfocusout="Main.onSearchResourceResultsFocusChance()">
        <div id="search-width-mirror" class="topbar-search-text width-mirror"></div>
      </div>
      <div style="grid-area: results; display: none" class="topbar-search-results" id="resource-search-results"></div>
    </div>
  </div>
  <div id="scale-display" class="scale-display">uhh scale</div>

  <div id="recipe-selector" class="recipe-selector" style="display: none">
    <div class="recipe-selector-header">
      <div>Recipe Selector</div>
      <input type="button" class="close-button" value="-" onclick="Main.closeRecipeSelectionMenu()">
    </div>
    <div id="selector-type" class="recipe-selector-types"></div>
    <table id="selector-recipe" class="recipe-selector-recipes">
      <tbody></tbody>
    </table>
  </div>

  <div id="workspace-container" class="workspace-container">
    <div id="recipes"></div>
    <svg id="connections"
         style="pointer-events: none; position: absolute; top: 0; left: 0; z-index: 900"
         width="100" height="100" viewBox="0 0 100 100">
    </svg>
  </div>

  <!--Templates-->
  <div>

    <template id="resource-search-result-template">
      <div class="topbar-search-results-item" onmousedown="Main.selectSearchResult(this)"></div>
    </template>

    <template id="recipe-selector-type-template">
      <div class="recipe-selector-recipe-type" onclick="Main.selectRecipeType(this)"></div>
    </template>
    <template id="recipe-selector-recipe-template">
      <tbody class="recipe-selector-recipe" onclick="Main.selectRecipe(this)">
        <tr>
          <td class="recipe-selector-recipe-header" colspan="4"></td>
        </tr>
        <tr>
          <td class="recipe-selector-i recipe-selector-recipe-input-resources"></td>
          <td class="recipe-selector-i recipe-selector-recipe-input-counts"></td>
          <td class="recipe-selector-o recipe-selector-recipe-output-resources"></td>
          <td class="recipe-selector-o recipe-selector-recipe-output-counts"></td>
        </tr>
      </tbody>
    </template>

    <template id="recipe-template">
      <div class="recipe">
        <script type="application/json" id="recipe-json"></script>
        <div id="recipe-header" class="recipe-header">
          <div style="grid-area: name" class="recipe-header-name">Recipe</div>
          <div style="grid-area: quantity" class="recipe-header-quantity">x1</div>
          <input style="grid-area: close" type="button" class="close-button" value="-" onclick="Main.deleteRecipe(this.parentNode.parentNode)">
        </div>
        <table class="recipe-data" id="recipe-data">
          <tbody></tbody>
        </table>
      </div>
    </template>

    <template id="recipe-row-connector-template">
      <td class="recipe-row-connector" ondragover="Main.recipeConnectionDragover(event)" ondrop="Main.recipeConnectionDrop(event)">
        <div draggable="true" ondragstart="Main.recipeConnectionDragStart(event)">
          <svg width="12" height="12"><circle r="5" cx="6" cy="6" fill="var(--item-color)" stroke="black" stroke-width="1px"/></svg>
        </div>
      </td>
    </template>
    <template id="recipe-row-connector-disabled-template">
      <td class="recipe-row-connector-disabled ">
        <div><svg width="12" height="12"></svg></div>
      </td>
    </template>
    <template id="recipe-row-key-template">
      <td class="recipe-row-key"></td>
    </template>
    <template id="recipe-row-value-template">
      <td class="recipe-row-value"></td>
    </template>
    <template id="recipe-row-evaluation-start-template">
      <td class="recipe-row-value">
        <input type="checkbox" onclick="Main.setEvaluateElement(this.parentElement.parentElement.parentElement.parentElement.parentElement)">
      </td>
    </template>
    <template id="recipe-row-rate-template">
      <td class="recipe-row-value">
        <input type="number" value="1" onchange="Main.evaluate()" disabled>
      </td>
    </template>

    <template id="recipe-connection-template">
      <svg>
        <path d="M 0 0 c 100 100, 200 0, 300, 100" stroke="var(--item-color)" stroke-width="4" fill="none"/>
      </svg>
    </template>
  </div>
</body>

</html>
